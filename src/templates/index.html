{% extends "base.html" %}

{% block title %}Malaria Detection App{% endblock %}

{% block content %}
<div class="full-height-container d-flex flex-column">
    <div class="row flex-grow-1 d-flex justify-content-center align-items-center">
        <div class="col-md-12 text-center">
            <div class="container">
                <img src="{{ url_for('static', filename='img/cells.webp') }}" alt="Site Logo" style="max-width: 400px; height: auto; margin-bottom: 0px;">
                <h1>Malaria Detection App</h1>

                <h4>Drag and drop an image to let the AI model detect if it is infected with malaria or not</h4>

                <!-- File Drop Zone Section -->
                <form action="{{ url_for('main.analysis') }}" method="POST" enctype="multipart/form-data" id="upload-form">
                    <div id="drop-zone">
                        <p id="drop-zone-text">Drag & drop your file here or click to upload</p>
                        <input type="file" name="file" id="file-upload" accept=".jpg,.jpeg,.png">
                    </div>
                    <button type="submit" style="background-color: #4CAF50; color: white; border: none; padding: 10px 20px; font-size: 16px; margin-top: 20px; cursor: pointer; border-radius: 5px;">
                        <img src="https://img.icons8.com/?size=100&id=62903&format=png&color=FFFFFF" alt="Search Icon" style="max-height: 20px;"> Analyze
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    body {
        background-color: #202020;
        color: white;
    }
    .full-height-container {
        height: calc(100vh - 50px);
    }
    .container {
        text-align: center;
        transform: translateY(-50px);
    }
    .row {
        margin: 0;
    }
    #drop-zone {
        margin-top: 20px;
        border: 2px dashed #4CAF50;
        height: 200px; /* Increased height */
        padding: 20px;
        border-radius: 10px;
        cursor: pointer;
        text-align: center;
        color: white;
        font-size: 16px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }
    #drop-zone p {
        margin: 0;
    }
    #file-upload {
        display: none; /* Hide the default file input */
    }
</style>

<script>
    const dropZone = document.getElementById("drop-zone");
    const fileInput = document.getElementById("file-upload");
    const dropZoneText = document.getElementById("drop-zone-text");
    const uploadForm = document.getElementById("upload-form");

    dropZone.addEventListener("click", () => {
        fileInput.click(); // Trigger the file input click
    });

    dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.style.borderColor = "#00FF00"; // Highlight border
    });

    dropZone.addEventListener("dragleave", () => {
        dropZone.style.borderColor = "#4CAF50"; // Reset border color
    });

    dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.style.borderColor = "#4CAF50"; // Reset border color

        if (e.dataTransfer.files.length) {
            fileInput.files = e.dataTransfer.files; // Assign dropped files to the input
            const fileName = e.dataTransfer.files[0].name; // Get file name
            dropZoneText.textContent = `Selected file: ${fileName}`;
        }
    });

    fileInput.addEventListener("change", () => {
        if (fileInput.files.length) {
            const fileName = fileInput.files[0].name; // Get file name
            dropZoneText.textContent = `Selected file: ${fileName}`;
        }
    });
</script>
{% endblock %}